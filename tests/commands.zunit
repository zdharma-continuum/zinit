#!/usr/bin/env zunit
#
# zdharma-continuum/zinit/zinit.zsh
# Copyright (c) 2016-2021 Sebastian Gniazdowski
# Copyright (c) 2021-2023 zdharma-continuum
# Homepage: https://github.com/zdharma-continuum/zinit
# License: MIT License
#

@setup {
  zinit default-ice --quiet from'gh-r' nocompile lbin'!'
  ZBIN="${ZPFX}/bin"
}

@test 'zinit delete' { # zinit delete subcommand
  # --help
  run zinit delete --help;  assert $state equals 0
  # --all --yes
  run zinit from'gh-r' id-as nocompile lbin'!' for @nektos/act; assert $state equals 0
  local act_bin="$ZBIN/act"; assert "$act_bin" is_executable
  bin_dir="$(ls $ZBIN)"; assert "$bin_dir" is_not_empty
  $act_bin --version; assert $state equals 0
  run zinit delete --all --yes; assert $state equals 0
  bin_dir="$(ls $ZBIN)"; assert "$bin_dir" is_empty
}
